<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>OpenLLM for Excel</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/github-markdown-css/5.1.0/github-markdown.min.css">
  <!-- Office JavaScript API -->
  <script type="text/javascript" src="https://appsforoffice.microsoft.com/lib/1.1/hosted/office.js"></script>

  <!-- For more information on Fluent UI, visit https://developer.microsoft.com/fluentui#/. -->
  <link rel="stylesheet" href="https://static2.sharepointonline.com/files/fabric/office-ui-fabric-core/11.0.0/css/fabric.min.css"/>

  <!-- Template styles -->
  <link href="taskpane.css" rel="stylesheet" type="text/css" />
</head>
<script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
<body class="ms-font-m ms-welcome ms-Fabric">
<section id="sideload-msg" class="ms-welcome__main">
  <h2 class="ms-font-xl">Please <a target="_blank" href="https://learn.microsoft.com/office/dev/add-ins/testing/test-debug-office-add-ins#sideload-an-office-add-in-for-testing">sideload</a> your add-in to see app body.</h2>
</section>
<main id="app-body" class="ms-welcome__main" style="display: none;">
  <button class="ms-Button" id="create-table">サンプルテーブルを作成する</button>
</main>
</body>
<div id="api-key-container">
  <label for="api-key-input">APIキー:</label>
  <input type="password" id="api-key-input" placeholder="APIキーを入力"/>
</div>
<div id="model-select-container">
  <label for="model-select">モデル選択:</label>
  <select id="model-select">
    <optgroup label="OpenAI チャット">
      <option value="openai:gpt-4o">GPT-4o（推奨・画像入力対応）</option>
      <option value="openai:gpt-4o-mini">GPT-4o mini（画像入力対応）</option>
      <option value="openai:gpt-4.1">GPT-4.1</option>
      <option value="openai:gpt-4-turbo">GPT-4 Turbo</option>
    </optgroup>
    <optgroup label="OpenAI 画像生成">
      <option value="openai-image:gpt-image-1">GPT Image 1（画像生成）</option>
    </optgroup>
    <optgroup label="Anthropic Claude">
      <option value="claude:claude-sonnet-4-5-20250929">Claude Sonnet 4.5（推奨・画像/PDF入力対応）</option>
      <option value="claude:claude-haiku-4-5-20251001">Claude Haiku 4.5（画像/PDF入力対応）</option>
      <option value="claude:claude-opus-4-5-20251101">Claude Opus 4.5（画像/PDF入力対応）</option>
    </optgroup>
    <optgroup label="Google Gemini チャット">
      <option value="gemini:gemini-2.0-flash">Gemini 2.0 Flash（推奨・画像/PDF入力対応）</option>
      <option value="gemini:gemini-2.5-flash">Gemini 2.5 Flash（画像/PDF入力対応）</option>
      <option value="gemini:gemini-2.5-pro">Gemini 2.5 Pro（画像/PDF入力対応）</option>
    </optgroup>
    <optgroup label="Google Gemini 画像生成">
      <option value="gemini-image:gemini-3-pro-image-preview">Gemini 3 Pro Image（画像生成）</option>
    </optgroup>
  </select>
</div>
<div id="file-upload-container">
  <label for="file-input">📎 ファイル添付（画像/PDF）:</label>
  <input type="file" id="file-input" accept="image/*,.pdf" multiple />
  <div id="file-preview"></div>
  <button id="clear-files-button" style="display:none;">添付をクリア</button>
</div>
<div id="chat-container">
  <div id="message-area" class="markdown-body"></div> 
  <input type="text" id="message-input" placeholder="メッセージを入力"/>
  <button id="send-button">送信</button>
  <button id="generate-image-button">画像生成</button>
  <button id="execute-excel-code-button">マクロ実行</button>
</div>
<div id="cell-info">
  <button class="ms-Button" id="refresh-cell-info">セル情報を更新する</button>
  <p id="selected-cell-address">選択中のセル: None</p>
  <p id="selected-cell-value">セルの値: None</p>
</div>
<div id="messageBar"></div>
</html>
